<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
<style>
body {
	background-color: black;
	color: white;
	font-family: sans-serif;
}
</style>
</head>
<body>

	<textarea id="input"></textarea>
	<div>Call: <span id="call"></span></div>
	<div>Exchange: <span id="exchange"></span></div>
	<div>Section: <span id="section"></span></div>
	<div>Notes: <span id="notes"></span></div>
<script>

	let input    = document.getElementById("input");

	let rgex = {
		call:     /\b([vwank][a-z]?[0-9][a-z]{1,5})(\/\w+)?\b/i,
		exchange: /\b([0-9]+)([a-f]b?)\b/i,
		section:  /\b([a-z]{2,3})\b/i,
		dxcall:   /\b([a-z0-9]{1,3}[0-9][a-z0-9]{0,3}[a-z])\b/i,
		notes:    /\[(.*)\]/i
	};

	let output = {
		call:     document.getElementById("call"),
		exchange: document.getElementById("exchange"),
		section:  document.getElementById("section"),
		notes:    document.getElementById("notes")
	};


	let data = {
		call:    null,
		class:   null,
		tx:      null,
		section: null,
		notes:   null
	};

	input.addEventListener("input", function(e) {

		output.call.innerHTML     = null;
		output.exchange.innerHTML = null;
		output.section.innerHTML  = null;
		output.notes.innerHTML    = null;

		data.call    = null;
		data.class   = null;
		data.tx      = null;
		data.section = null;
		data.notes   = null;

		let incoming = input.value;


		let findnotes = rgex.notes.exec(incoming);
		if (findnotes) {
			output.notes.innerHTML = data.notes = findnotes[1];
			incoming = incoming.replace(rgex.notes, "");
		}

		let findcall = rgex.call.exec(incoming);
		if (findcall) output.call.innerHTML = data.call = findcall[1].toUpperCase();

		let findex = rgex.exchange.exec(incoming);
		if (findex) {
			output.exchange.innerHTML = findex[0].toUpperCase();
			data.tx    = findex[1];
			data.class = findex[2].toUpperCase();
		}

		let findsec = rgex.section.exec(incoming);
		if (findsec) {
			output.section.innerHTML = data.section = findsec[1].toUpperCase();

			if (data.section == "DX") {
				let finddx = rgex.dxcall.exec(incoming);
				if (finddx) output.call.innerHTML = data.call = finddx[1].toUpperCase();
			}

		}

		console.log(data);


	});

	input.onkeydown = function (e) {
		if (e.keyCode == 13) {
			alert("enter");
		}
	};

</script>

</body>
</html>
